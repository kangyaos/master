
<!-- saved from url=(0034)http://www.xiao5u.com/Demo/Survey/ -->
<html xmlns="http://www.w3.org/1999/xhtml"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">





<title>大学生压力来源及解压方式调查_校无忧科技</title>

<meta name="author" content="校无忧科技_Www.Xiao5u.Com">
<meta name="description" content="校无忧问卷调查系统_Www.Xiao5u.Com">

<link href="${base}/assets/admin/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
<link href="${base}/assets/admin/plugins/uniform/css/uniform.default.css" rel="stylesheet" />
<link href="${base}/assets/admin/css/components.css" rel="stylesheet" />
<link href="${base}/assets/web/css/question.css" rel="stylesheet" type="text/css">
<script src="${base}/assets/admin/plugins/jquery.min.js"	type="text/javascript"></script>
<script	src="${base}/assets/admin/plugins/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
<script	src="${base}/assets/admin/plugins/jquery-ui/jquery-ui-1.10.3.custom.js" type="text/javascript"></script>
<script	src="${base}/assets/admin/plugins/uniform/jquery.uniform.min.js" type="text/javascript"></script>
</head>
<body>

<div class="container">
<input type="hidden" id="questionnum" value="${naire.questions?size}">
<input type="hidden" id="naireId" value="${naire.id!}">

<div class="row" id="banner" >${naire.name!}</div>
<div class="row" id="info" >${naire.remark!}</div>
<div class="row"  id="info2" ></div>
 <#if naire.questions??>
<#list naire.questions as question>
	<div class="form-group">
		<label><b>${question_index+1}、${question.question!}<#if question.questionType==1>[多选题]</#if> </b></label>
		 <#if question.questionType==0>
	    <div class="radio-list">
	     <#list 1..question.optionNum as num>
	       <#if answer??>
	            <#if num==1>
		     		<label><input type="radio" name="${question.questionId}"  value="${num}"  checked='${answer["${question.questionId}"]!}==${num}?checked:false'> ${question.optionA!}</label>
				 </#if>
				 <#if num==2>
			     	<label><input type="radio" name="${question.questionId}"  value="${num}"  checked=" ${answer['${question.questionId}']!}==${num}?checked:false"> ${question.optionB!}</label>
				 </#if>
				 <#if num==3>
			     	<label><input type="radio" name="${question.questionId}"  value="${num}"  checked=" ${answer['${question.questionId}']!}==${num}?checked:false"> ${question.optionC!} </label>
				 </#if>
				 <#if num==4>
			     	<label><input type="radio" name="${question.questionId}" value="${num}"  checked=" ${answer['${question.questionId}']!}==${num}?checked:false"> ${question.optionD!}</label>
				 </#if>
				   <#if num==5>
			     	<label><input type="radio" name="${question.questionId}"  value="${num}"  checked=" ${answer['${question.questionId}']!}==${num}?checked:false"> ${question.optionE!}</label>
				 </#if>
	       <#else>
		     <#if num==1>
		     	<label><input type="radio" name="${question.questionId}"  value="${num}" > ${question.optionA!}</label>
			 </#if>
			 <#if num==2>
		     	<label><input type="radio" name="${question.questionId}"  value="${num}" > ${question.optionB!}</label>
			 </#if>
			 <#if num==3>
		     	<label><input type="radio" name="${question.questionId}"  value="${num}" > ${question.optionC!}</label>
			 </#if>
			 <#if num==4>
		     	<label><input type="radio" name="${question.questionId}" value="${num}" > ${question.optionD!}</label>
			 </#if>
			   <#if num==5>
		     	<label><input type="radio" name="${question.questionId}"  value="${num}" > ${question.optionE!}</label>
			 </#if>
			</#if>
		 </#list> 
		</div>
	  <#else>
	   <div class="checkbox-list">
	       <#list 1..question.optionNum as num>
	         <#if answer??>
			     <#if num==1>
				     	<label><input type="checkbox" name="${question.questionId}" value="${num}" <#if answer['${question.questionId}']?index_of('${num}')!=-1> checked="checked"</#if> > ${question.optionA!}</label>
				    </#if>
				 <#if num==2>
			     	<label><input type="checkbox" name="${question.questionId}" value="${num}" <#if answer['${question.questionId}']?index_of('${num}')!=-1> checked="checked"</#if> > ${question.optionB!}</label>
				 </#if>
				 <#if num==3>
			     	<label><input type="checkbox" name="${question.questionId}" value="${num}" <#if answer['${question.questionId}']?index_of('${num}')!=-1> checked="checked"</#if> > ${question.optionC!}</label>
				 </#if>
				 <#if num==4>
			     	<label><input type="checkbox" name="${question.questionId}" value="${num}" <#if answer['${question.questionId}']?index_of('${num}')!=-1> checked="checked"</#if> >${question.optionD!}</label>
				 </#if>
				   <#if num==5>
			     	<label><input type="checkbox" name="${question.questionId}"  value="${num}" <#if answer['${question.questionId}']?index_of('${num}')!=-1> checked="checked"</#if> >${question.optionE!}</label>
				 </#if>
				<#else>
				  	<#if num==1>
				     	<label><input type="checkbox" name="${question.questionId}"  value="${num}" > ${question.optionA!}</label>
					 </#if>
					 <#if num==2>
				     	<label><input type="checkbox" name="${question.questionId}" value="${num}" > ${question.optionB!}</label>
					 </#if>
					 <#if num==3>
				     	<label><input type="checkbox" name="${question.questionId}" value="${num}" > ${question.optionC!}</label>
					 </#if>
					 <#if num==4>
				     	<label><input type="checkbox" name="${question.questionId}" value="${num}" > ${question.optionD!}</label>
					 </#if>
					   <#if num==5>
				     	<label><input type="checkbox" name="${question.questionId}"  value="${num}" > ${question.optionE!}</label>
					 </#if>
				</#if>
		 </#list> 
		
		</div>
	  
	  </#if>
		</div>
		</#list>
</#if>
	<div>	
	<#if    !answer??>
		<div class="form-actions">
			<div class="row">
				<div class="col-md-offset-5 col-md-12">
					<button type="submit" onclick="submitnaire()" class="btn blue button-submit">保存</button>
				
				</div>
			</div>
		</div>
	</#if>							
</div>
	
	
  
<script>
var map = new Map();
$(document).ready(function(){
   $('input[type=radio]').change(function() {
     map.set(this.name,this.value)
   });
   
   $("input[type=checkbox]").change(function() {
     	 var codes = "";
	     var elements = document.getElementsByName(this.name);
	     for (var i = 0; i < elements.length; i++) {
	           if (elements[i].checked == true) {
	               var temp = elements[i].getAttribute("value");
	              codes+=","+temp;
	           }
	       }
	       if(codes.length>1){
	         codes=codes.substring(1);
	       }
	        map.set(this.name,codes)
	        console.log(Object.keys(map).length)
	});
});

function submitnaire(){
  if(map.size<$("#questionnum").val()){
     alert("请答完题后再交卷！");
     return false;
  }else{
   $(".button-submit").attr('disabled','disabled').off('click');
   	$.ajax({
            type : "POST",
            url : "submitAnswerRecord.do",
            data:{
	             "questions":JSON.stringify(this._strMapToObj(map)),
	             "id":$("#naireId").val(),
            },
             async:false, 
            success : function(result) {
              alert("提交成功");
            }, error : function(result) {
            $(".button-submit").attr('disabled',false).off('click');
             alert("网络连接失败，请稍后再试！");
            }
    })  
   
  }
  

}

 function _strMapToObj(strMap){
    let obj= Object.create(null);
    for (let[k,v] of strMap) {
      obj[k] = v;
    }
    return obj;
  }

</script>


</body></html>
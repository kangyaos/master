<!DOCTYPE HTML>
<html>
<head>
<title>拉煤宝</title>
<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<link type="text/css" href="${base}/assets/web/css/reset1.css" rel="stylesheet">
<link type="text/css" href="${base}/assets/web/css/public.css" rel="stylesheet">
<link type="text/css" href="${base}/assets/web/css/register.css" rel="stylesheet">
<link rel="shortcut icon" href="${base}/favicon.ico" />
<script src="${base}/assets/web/js/jquery.min.js" type="text/javascript"></script>
<script src="${base}/assets/web/js/jquery.form.js" type="text/javascript"></script>
<script src="${base}/assets/web/js/json.parse.js" type="text/javascript"></script>


<style>
	.loginad{
		width:580px;
		height:595px;
		position: absolute;
	}
	.loginad .loginadtitle{
		width:100%;
		text-align:center;
		line-height:60px;
		font-size:32px;
		font-family:"幼圆",Microsoft Yahei;
		margin-top:70px;
		color:#FFF;
	}
	.loginad .loginaddes{
		line-height:30px;
		color:#FFF;
		font-family:Microsoft Yahei;
		font-size:16px;
		text-align:center
	}
	.loginad .loginadimg{
		width:100%; 
		height:320px;
		margin-top:40px;
		
	}
	.loginad .loginadbtn{ width:100%; height:40px; margin-top:30px; }
	.loginad .loginadbtn a{ display:block; width:190px; height:40px; margin:0 auto; text-align:center; line-height:40px; font-size:16px; color:#009fe3; font-weight:bold; background:url(/themes/images/v3/btn.png) center center no-repeat;
		-moz-border-radius:6px;
		-khtml-border-radius:6px;
		-webkit-border-radius:6px;
		border-radius:6px;
	}
	.simplenav{
	     padding: 60px;
	}
	.text-right{
	    float: right;
        margin-top: -115px;
	}
	.gh_img{
	   width: 50%;
	}
	.form_foot{
		width: 1200px;
	    margin: 0 auto;
	    position: relative;
	}
	.username{
		 width: 68%;
	    padding: 10px 5px 10px 10px;
	    border: 2px solid #1161ec; 
	    height: 15px;
	    line-height: 20px;
	    margin-bottom: 10px;
	    border-radius: 4px;
	    color: #666;
	}
	.smsverification{
		width: 45%;
	    padding: 10px 5px 10px 10px;
	    border: 2px solid #1161ec; 
	    height: 14px;
	    line-height: 20px;
	    margin-bottom: 10px;
	    border-radius: 4px;
	    color: #666;
	}
	.button_getcode{
		height: 17px;
        line-height: 18px;
        padding: 9px 5px 10px 10px;
        background: #1161ec;
        border: 1px #1161ec solid;
        border-radius: 4px;
        color: #fff;
        display: inline-block;
        text-decoration: none;
        font-size: 13px;
        outline: none;
	}
	input:disabled{
		border:1px solid #DDD;
		background-color:#F5F5F5;
		color:#ACA899;
	}	
@media only screen and (max-width: 600px){
	#header, #menu {
	    width: 100%;
	    min-width: 220px;
	    background: #fff;
	}
	.form_foot {
	    width: 100%;
	    margin: 0 auto;
	    position: relative;
	}
	.header {
	    width: 100%;
	    margin: 0 auto;
	    height: 100px;
	    line-height: 100px;
	    padding-top: 15px;
	    position: relative;
	}
	.login_bg {
	    width: 100%;
	    min-width: 280px;
	    height: 420px;
	    background: url(../images/img/login_banner.png) center center no-repeat #fff;
	}
	.loginad {
	    width: 0px;
	    height: 0px;
	    position: absolute;
	}
	#login_form {
	    width: 80%;
	    position: inherit;
	    TEXT-ALIGN: CENTER;
	    top: 70px;
	    right: 0%;
	    left: 6%;
	    margin: 0;
	    padding: 0;
	}
	.username, .pw {
	    width: 73%;
	    padding: 10px 5px 10px 10px;
	    border: 2px solid #1161ec; 
	    height: 20px;
	    line-height: 20px;
	    margin-bottom: 10px;
	    border-radius: 4px;
	    color: #666;
	}
	
	#login_form h2 {
	    font-size: 20px;
	    font-weight: bold;
	    height: 20px;
	    line-height: 20px;
	    margin-bottom: 24px;
	    margin-left:24px;
	}
	.login_btn {
	 display: block;
     height: 35px;
     width: 258px;
     box-shadow: 0 2px 1px #999;
     margin-top: 20px;
     margin-left: 10%;    
	}
	.form {
	    width: 100%;
	    height: 420px;
	    margin: 0 auto;
	    position: relative;
	}
	.header h1 {
	    left: 10PX;
	}
	.header a {	   
	    font-size: 16px;
	}
	.simplenav{
	     padding: 30px;
	}
	.text-right{
	    width: 100%;
        text-align: center;
        float: right;
        margin-top: 0;
	}
	.gh_img{
	   width: 30%;
	}
	
}
</style>
</head>
<body>
	<div id="header">
		<div class="header">
			<h1 class="png_bg">拉煤宝</h1>
			<a href="${base}/">返回主页</a>
		</div>
	</div>	
	<div class="login_bg">
		<div class="form">
        	<div class="loginad">
                <div class="loginadimg" style="background:url('') center center no-repeat"></div>
            </div>
            <div>
            	
            </div>		
			<form name="loginForm" id="login_form">
				<h2>注册</h2>
				<div>
				  <div style="margin-bottom:10px; color:#1161ec;width: 116px;"><label >手机号</label></div>
				<div>
				   <input class="username" name="username"  onkeyup="this.value=this.value.replace(/\D/g,'')" onblur="isexist(this.value)"/></div>
				</div>
				<div>
				
				 <div  style="margin-bottom:10px; color:#1161ec;width: 116px;"> <label>验证码</label></div>
				  <div>
				   <input class="smsverification" name="smsverification"  id="sms" onkeyup="this.value=this.value.replace(/\D/g,'')" maxlength="4"/>
					<a href="javascript:void(0);" id="user_getcode" class="button_getcode" target="_self" >获取验证码</a>
					</div>
					
				</div>
				<div style="width: 163px;">
					<input type="checkbox" id="ischeck" onclick="boxclick()" checked="checked"><label style="color:#1161ec;">阅读并接受</label>
				</div>
				<div  style="color:#ee8e1;margin-top:5px">
				   <a href="${base}/useragreement.html" style = "text-decoration: unset; color:#ee8e11;font-size:14px;"   target="_blank">《拉煤宝平台用户及隐私安全协议》</a>
				</div>
				<div><input class="login_btn" id="register" onclick=" registerclick()" value="立即注册" /></div>
                <div style="line-height:30px; text-indent:5px;color:#F30" id="loginTips">&nbsp;${error!}</div>
                <div id="third">
                <a href="https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx21c61308a6d56bd1&redirect_uri=http://41a79509.ngrok.io/lamweb/web/redirectWx.html&response_type=code&scope=snsapi_userinfo&state=1#wechat_redirect ">微信注册</a>
                </div>
			</form>
			<div class="modal-body" id="text"></div>
		</div>
	</div>	
	<div>
		<div class="form_foot">
        	<p class="simplenav">
				Copyright © 2014-2018 陕西光环网络科技有限公司 版权所有 陕ICP备14011719号
			</p>			
			<p class="text-right">
				<img src="${base}/assets/web/images/img/123.jpg" class="gh_img"/>
			</p>
		</div>			
	</div>
<!-- footer start -->

<!-- footer end -->
<script src="//res.wx.qq.com/connect/zh_CN/htmledition/js/wxLogin.js" type="text/javascript"></script>
<!-- 
<script type="text/javascript" src="http://qzonestyle.gtimg.cn/qzone/openapi/qc_loader.js" data-appid="1106765968" data-redirecturi="S0AoZOdeyPHlSX03" charset="utf-8"></script>
 -->
<script type="text/javascript">
	
	var head=0;
	//微信注册是否显示
	 window.onload = function(){
	 	$("#third").css("display","none");
	 	if(is_weixn()){
	 		$("#third").css("display","block");
	 	}
	 }
	//阅读并接受协议
	function boxclick(){
		if($("input[type='checkbox']").is(':checked')){
			$("#register").removeAttr('disabled');
		}else{
			$("#register").attr('disabled',true);
		}
	}
	
	//发送验证码
	$("#user_getcode").click(function(){
		var username=$("input[name='username']").val();
		if(username==""||!checkTel(username)){
			$("#loginTips").html("请输入正确的电话号码!").fadeIn();
		}else if(isexist(username)=="200"){
			 $.ajax({
			 	url:"sendSMS.do",
			 	data:{phonenum:username},
			 	success:function(smscode){
			 		 leftSeconds = 60;
	                 msgSendToTip();
	                 $("#loginTips").fadeOut();
			 	}
			});
		}
	});
	
	//倒计时60s
	 function msgSendToTip() {
      $("#user_getcode").unbind('click');
      timeIntervalId = setInterval(function() {
         if (leftSeconds <= 1) {
           // $('#user_getcode').removeAttr('disable');
            $('#user_getcode').removeClass('countdown');
            $('#user_getcode').css({
               "cursor" : "pointer"
            });
            $("#user_getcode").html("获取验证码");
            clearInterval(timeIntervalId);
            $('#user_getcode').bind('click');
            leftSeconds = 10;
            head=2;
            return;
         }
         leftSeconds--;
         $('#user_getcode').addClass('countdown');
         $('#user_getcode').css({
            "cursor" : "auto",
         });
         head=1;
         $("#user_getcode").html(leftSeconds + "秒后重发");
      }, 1000);
   }
   //立即注册点击
   function registerclick(){
		var username=$("input[name='username']").val();
		if(username==""||!checkTel(username)){
				$("#loginTips").html("请输入正确的电话号码!").fadeIn();
		}else{
			var sms=$("#sms").val();
			if(head==0){
				$("#loginTips").html("亲，您还没有获取验证码!").fadeIn();
			}else if(head==2){
				$("#loginTips").html("亲，您的验证码已失效，请重新获取!").fadeIn();
			}else if(sms==""){
				$("#loginTips").html("亲，您还没有输入验证码!").fadeIn();	
			}else{
				smscodecheck(sms);
			}
		}
		$(this).attr('disabled','disabled').off('click');		
	}
	//判断验证码
	function smscodecheck(sms){
		var username=$("input[name='username']").val();
		$.ajax({
		 	url:"checkSMS.do",
		 	data:{phonenum:username,code:sms},
		 	success:function(data){
		 		if(data){
					window.location.href="checkregister.html?phonenum="+username;
				}else{
					$("#loginTips").html("亲，您验证码输入有误,请重新输入!").fadeIn();	
				}
		 	}
		});
	}
	
	//手机号码校验
	function checkTel(tel){
	   var mobile = /^1[3|5|8]\d{9}$/ , phone = /^0\d{2,3}-?\d{7,8}$/;
	   return mobile.test(tel) || phone.test(tel);
	}
	//手机号是否存在
	var res=null;
	function isexist(value){
		if(!checkTel(value)){
			$("#loginTips").html("请输入正确的电话号码!").fadeIn();
		}else{
			 $.ajax({
			 	url:"isexist.html",
			 	type: "GET",
			 	data:{phonenum:value},
			 	success:function(result){
			 		 if(result=="100"){
			 		 	$("#loginTips").html("该电话号码已经注册，请重新输入!").fadeIn();
			 		 }else{
			 		 	$("#loginTips").fadeOut();
			 		 }
			 		 res=result;
			 	}
			});
		}
		return res;
	}
	
	//判断是否在微信中打开
	function is_weixn() {
		var ua = navigator.userAgent.toLowerCase();
		if (ua.match(/MicroMessenger/i) == "micromessenger") {
			return true;
		} else {
			return false;
		}
	}
</script>

	
</body>
</html>

















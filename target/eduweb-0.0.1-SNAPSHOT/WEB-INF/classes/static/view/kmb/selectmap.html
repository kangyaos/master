<div class="modal fade bs-modal-lg" id="selmap" tabindex="-1"
	role="dialog" aria-hidden="true" data-backdrop="static"
	data-keyboard="false">
	<div class="modal-dialog modal-lg" style="width:93%">
		<div class="modal-content" style="height:450px;">
			<div id="container" class="map" tabindex="0"></div>
			<div id='right' style="height:150px; ">
				<div>
					<br>
					<input type="hidden" id="lnglat" /> 
					<input type="hidden" id="lnglat" />
					<div id="minenamediv">
						<span class='c' style="float: left; margin: 7px 0;">矿口名称:</span>  
						<input name='mineName' id="mapmineName" class="form-control" style=" width: 260px;"	placeholder="请输入矿口名称" /> 
						<span style="margin-left: 72px;color:#a94442;display: none;" id="nameloginTips">请输入矿口名称</span>
					</div>
					<span class='c'>地址:</span> 
					<span id='address'></span>
					<div class="row" style="text-align:center;margin-top: 10px;">
						<button id="btn  btn-default" id="closebutton"
							onclick="toclose(0)">关闭</button>
						<button id="btn" onclick="selRes(0)">确定</button>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

<!-- <base href="//webapi.amap.com/ui/1.0/ui/misc/PositionPicker/examples/" /> -->

<!-- UI组件库 1.0 -->
<script type="text/javascript"
	src='//webapi.amap.com/maps?v=1.4.12&key=abeebe4dc81a2fe52c04f465f4fe76d9&plugin=AMap.ToolBar'></script>
<script src="//webapi.amap.com/ui/1.0/main.js?v=1.0.11"></script>


<script type="text/javascript">

	AMapUI.loadUI([ 'misc/PositionPicker' ], function(PositionPicker) {
		var map = new AMap.Map('container', {
			zoom : 10,
			scrollWheel : false
		})
		var positionPicker = new PositionPicker({
			mode : 'dragMap',
			map : map
		});

		positionPicker.on('success', function(positionResult) {

			$("#lnglat").val(positionResult.position)
			if (position == '')
				position = positionResult.position;
			document.getElementById('address').innerHTML = positionResult.address;
			fromregcode = positionResult.regeocode.addressComponent.adcode;
			province1 = positionResult.regeocode.addressComponent.province;
			district = positionResult.regeocode.addressComponent.district;
			city = positionResult.regeocode.addressComponent.city;
		});
		positionPicker.on('fail', function(positionResult) {
			document.getElementById('mineName').innerHTML = ' ';
			document.getElementById('address').innerHTML = ' ';
		});

		positionPicker.start([ 108.947025, 34.259518 ]);
		map.panBy(0, 1);

		map.addControl(new AMap.ToolBar({
			liteStyle : true
		}))
	});


	function toclose(minemouthId) {
		if ($("#addstate").val() == 1) {
			minemouthId = $("#mineitemId").val();
			$('#mineitem' + minemouthId).remove();
		}
		$('#selmap').modal('hide');
	}

	function selRes(minemouthId) {
		minemouthId = $("#mineitemId").val();
		if ($("#mapmineName").val() == '' && minemouthId != 0) {
			$("#nameloginTips").show();
		} else {
			$("#nameloginTips").hide();

			var fromName = province1 + city + district;
			$("#saleaddressstr" + minemouthId).html($("#address").html());

			$("#minename" + minemouthId).html($("#mapmineName").val());
			$("#saleaddressstr" + minemouthId).val($("#address").html());
			$("#saleaddress" + minemouthId).val($("#address").html().replace(fromName, ""));
			$("#regionCode" + minemouthId).val(fromregcode + '000');
			$("#longitude" + minemouthId).val($("#lnglat").val().split(',')[0]);
			$("#latitude" + minemouthId).val($("#lnglat").val().split(',')[1]);
			$('#selmap').modal('hide');
		}

	}
</script>

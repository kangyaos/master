<!DOCTYPE html>
<html lang="zh-CN">
<!-- BEGIN HEAD -->
<head>
<meta name="viewport"
	content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="${goods.sales.companyName!}${goods.coalName!}发热量${goods.calorificValue!}KCal/kg一票价${goods.oneQuote!}元/吨" />
<meta name="image" itemprop="image" content="http://www.17lm.com/assets/image/44.png" />
<meta name="author" content="" />
<title>煤炭详情</title>
<link rel="stylesheet" href="${base}/assets/css/bootstrap.min.css"/>
<link rel="stylesheet" href="${base}/assets/css/components.css"  />
<style type="text/css">
.portlet {
    margin-bottom: 0px;
}
.portlet > .portlet-title {
    border-bottom: 2px solid #1e7aea;
    padding-top: 20px;
    margin-bottom: 0px;
    min-height: 60px;
}
.portlet > .portlet-title > .caption {
    font-size: 20px;
    padding: 10px 0;
}
.portlet > .portlet-title > .tools {
    padding: 8px 0 0 0; 
}
.table {
	width: 100%;
}
.table tr{
	font-size: 16px;
	height: 30px;
	line-height: 30px;
}
.table tr:last-child{
	border-bottom: 1px solid #ddd;
}
h4 {
    font-weight: 700;
    font-size: 16px;
    margin: 0px;
}
.price-table {
	border-left: 3px solid #F0F4F8;
	border-right: 3px solid #F0F4F8;
    border-bottom: 3px solid #F0F4F8;
}
.pricename {
	color: #666;
	font-size: 18px;
	font-weight: 900;
	text-align: center;
}
.pricered {
    color: #e55f48;
    font-size: 18px;
    font-weight: 600;
    text-align: center;
}
.address {
	margin: 10px 0 0;
	font-size: 16px;
	color: #666;
}
.address>tbody>tr>td{
	padding: 0;
	border: none;
}
.address tr:last-child{
	border-bottom: none;
}
.nav>li>a {
    position: relative;
    display: block;
    padding: 1px;
    text-align: center;
    color: #000;
    background-color: #f1f1f1;
    border: 1.5px solid #f1f1f1;
    border-radius: 0;
}
.nav-pills>li+li {
    margin-left: 0px;
}
.nav-pills>li {
    float: left;
    width: 25%;
    padding:2px;
}
.nav-pills>li.active>a, .nav-pills>li.active>a:hover, .nav-pills>li.active>a:focus {
    color: #000; 
    background-color: #fff;
 
}
</style>
<!-- 微信 JS-SDK -->
<script src="//res.wx.qq.com/open/js/jweixin-1.4.0.js"></script>
<script type="text/javascript">

	wx.config({
		appId : '${appId!}', // 必填，公众号的唯一标识
		timestamp : '${timeStamp!}', // 必填，生成签名的时间戳
		nonceStr : '${nonceStr!}', // 必填，生成签名的随机串
		signature : '${signature!}', // 必填，签名 
		jsApiList : ['onMenuShareAppMessage','onMenuShareTimeline', 'onMenuShareQQ', 'onMenuShareQZone']
	});

	wx.ready(function() {

		// 分享给朋友
		wx.onMenuShareAppMessage({
			title : '${goods.coalName!}', // 分享标题
			desc : '${goods.sales.companyName!}${goods.coalName!}发热量${goods.calorificValue!}KCal/kg一票价${goods.oneQuote!}元/吨', // 分享描述
			link : '${url!}', // 分享链接，该链接域名或路径必须与当前页面对应的公众号JS安全域名一致
			imgUrl : 'http://www.17lm.com/assets/image/44.png', // 分享图标
			success : function() {
				// 用户确认分享后执行的回调函数
			},
			cancel : function() {
				// 用户取消分享后执行的回调函数
			}
		});
		
		// 分享到朋友圈
		wx.onMenuShareTimeline({
			title : '${goods.coalName!}', // 分享标题
			link : '${url!}', // 分享链接，该链接域名或路径必须与当前页面对应的公众号JS安全域名一致
			imgUrl : 'http://www.17lm.com/assets/image/44.png', // 分享图标
			success : function() {
				// 用户确认分享后执行的回调函数
			},
			cancel : function() {
				// 用户取消分享后执行的回调函数
			}
		});

		// 分享到QQ
		wx.onMenuShareQQ({
			title : '${goods.coalName!}', // 分享标题
			desc : '${goods.sales.companyName!}${goods.coalName!}发热量${goods.calorificValue!}KCal/kg一票价${goods.oneQuote!}元/吨', // 分享描述
			link : '${url!}', // 分享链接，该链接域名或路径必须与当前页面对应的公众号JS安全域名一致
			imgUrl : 'http://www.17lm.com/assets/image/44.png', // 分享图标
			success : function() {
				// 用户确认分享后执行的回调函数
			},
			cancel : function() {
				// 用户取消分享后执行的回调函数
			}
		});

		// 分享到QQ空间
		wx.onMenuShareQZone({
			title : '${goods.coalName!}', // 分享标题
			desc : '${goods.sales.companyName!}${goods.coalName!}发热量${goods.calorificValue!}KCal/kg一票价${goods.oneQuote!}元/吨', // 分享描述
			link : '${url!}', // 分享链接，该链接域名或路径必须与当前页面对应的公众号JS安全域名一致
			imgUrl : 'http://www.17lm.com/assets/image/44.png', // 分享图标
			success : function() {
				// 用户确认分享后执行的回调函数
			},
			cancel : function() {
				// 用户取消分享后执行的回调函数
			}
		});

	});

	wx.error(function(res) {
		// config信息验证失败会执行error函数，如签名过期导致验证失败，具体错误信息可以打开config的debug模式查看，也可以在返回的res参数中查看，对于SPA可以在这里更新签名。
		console.log('weixin 验证失败');
		console.log(res);
	});
</script>
</head>
<body>
	<div class="container">
		<#if goods.sales??>
		<div class="portlet">
			<div class="portlet-title">
				<div class="caption">
					<b>${goods.sales.companyName!}</b>
				</div>
				<div class="tools">
					<#if goods.sales.longitude??>
					<img src="${base}/assets/image/position.png" style="width:20px;height:20px;">
					</#if>
				</div>
			</div>
			<div class="portlet-body">
				<#if coalSalePicUrl??>
				<div style="height:150px;text-align:center;">
					<img src="${coalSalePicUrl!}" style="height:100%;width:100%;">
				</div>
				</#if>
				<table class="table address">
					<tbody>
						<tr>
							<td style="width: 83px;">联&nbsp;&nbsp;系&nbsp;&nbsp;人：</td>
							<td>${goods.userInfo.realName!}</td>
							<td style="float:right;"><a href="tel:${userMobile!}">
							<img src="${base}/assets/image/phone1.png" style="width:20px;height:20px;"></a></td>
						</tr>
						<tr>
							<td style="width: 83px;">详细地址：</td>
							<td colspan="2">${salesRegionName!}${goods.sales.address!}</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
		</#if>
		<div class="clearfix"></div>
		<div class="portlet">
			<div class="portlet-title">
				<div class="caption">
					<b>${goods.coalName!}</b>
				</div>
			</div>
			<div class="portlet-body">
			<table class="table table-hover">
				<colgroup>
					<col style="width: 50%"/>
					<col style="width: 50%"/>
				</colgroup>
				<tbody>
					<tr>
						<td><h4>基本信息</h4></td>
					</tr>
					<tr>
						<td>发热量</td>
						<td><#if goods.calorificValue?? && goods.calorificValue!=0>${goods.calorificValue}KCal/kg</#if></td>
					</tr>
					<!--<tr>
						<td>粒度</td>
						<td><#if goods.grainSize?? && goods.grainSize!="">${goods.grainSize}mm</#if></td>
					</tr> -->
					<tr>
						<td>挥发分</td>
						<td><#if goods.volatileValue?? && goods.volatileValue!=0>${goods.volatileValue}%</#if></td>
					</tr>
					<tr>
						<td>全水分</td>
						<td><#if goods.totalMoisture?? && goods.totalMoisture!=0>${goods.totalMoisture}%</#if></td>
					</tr>
					<tr>
						<td>全硫分</td>
						<td><#if goods.totalSulfur?? && goods.totalSulfur!=0>${goods.totalSulfur}%</#if></td>
					</tr>
					<tr>
						<td>固定碳</td>
						<td><#if goods.fixedCarbon?? && goods.fixedCarbon!=0>${goods.fixedCarbon}%</#if></td>
					</tr>
					<tr>
						<td>灰分</td>
						<td><#if goods.ashValue?? && goods.ashValue!=0>${goods.ashValue}%</#if></td>
					</tr>
					<tr>
						<td>加工工艺</td>
						<td><#if goods.technology?? && goods.technology!="">${goods.technology}</#if></td>
					</tr>
				</tbody>
			</table>
			</div>
		</div>
		<div class="clearfix"></div>
		<#if coalReportPicUrl??>
		<div class="portlet">
			<div class="portlet-title">
				<div class="caption">
					<b>化验单</b>
				</div>
			</div>
			<div class="portlet-body">
				<div style="height:150px;text-align:center;">
					<img src="${coalReportPicUrl!}" style="height:100%;width:100%;">
				</div>
				<table class="table table-hover">
					<colgroup>
						<col style="width: 30%"/>
						<col style="width: 70%"/>
					</colgroup>
					<tbody>
						<tr>
							<td>化验单位</td>
							<td class="text-right">${goods.coalReportInstitution!}</td>
						</tr>
						<tr>
							<td>化验时间</td>
							<td class="text-right"><#if goods.coalReportTime??>${goods.coalReportTime?string("yyyy-MM-dd")}</#if></td>
						</tr>
				</table>
			</div>
		</div>
		</#if>
		<div class="clearfix"></div>
		<div class="portlet">
			<div class="portlet-title">
				<div class="caption">
					<b>价格</b>
				</div>
			</div>
			<div class="portlet-body">
				<table class="table table-hover price-table">
					<tbody>
						<tr>
							<td>
							<div class="pricename">一票价</div>
							<div class="pricered">
								<img src="${base}/assets/image/price.png" 
								height=12 style="margin-top:-5px"/>${goods.oneQuote!}
							</div>
							</td>
							<#if goods.isShowTwo?? && goods.isShowTwo==1>
							<#if goods.twoQuote?? && goods.twoQuote!=0>
							<td style="border-left: 3px dashed #F0F4F8;">
							<div class="pricename">二票价</div>
							<div class="pricered">
								<img src="${base}/assets/image/price.png" 
								height=12 style="margin-top:-5px"/>${goods.twoQuote!}
							</div>
							</td>
							</#if>
							</#if>
						</tr>
				</table>
			</div>
		</div>
		<div class="clearfix"></div>
		<div class="row" style="padding-top: 20px;">
			<div class="col-xs-12">
			<div class="row" style=" height: 40px;line-height: 40px;">
			  <div class="col-xs-6" style="font-size: 16px;">历史价位图</div>
			  <div class="col-xs-6" style="text-align:right;font-weight: bold;">价格(元/吨)</div>
			</div>
			<ul id="myTab" class="nav nav-pills" role="tablist">
			    <li class="active" onclick="inithighcharts(7)"><a href="#" role="tab" data-toggle="pill">7天</a></li>
			    <li class=""  onclick="inithighcharts(30)"><a href="#" role="tab" data-toggle="pill">1月</a></li>
			    <li class="" onclick="inithighcharts(180)"><a href="#" role="tab" data-toggle="pill">半年</a></li>
			    <li class="" onclick="inithighcharts(365)"><a href="#" role="tab" data-toggle="pill">1年</a></li>
			 </ul>
				<div id="container"	style="height: 300px;"></div>
			</div>
		</div>
		<div class="clearfix"></div>
		<#if goods.companies??>
		<div class="portlet">
			<div class="portlet-title">
				<div class="caption">
					<b>煤炭产地</b>
				</div>
			</div>
			<div class="portlet-body">
				<div style="font-size: 16px;margin:10px 0">
					<b>${goods.companies.mineMouthName!}</b>
					<#if goods.companies.longitude?? && share==1>
					<img src="${base}/assets/image/position.png" style="width:20px;height:20px; float: right;" onclick="companiesPosition();">
					</#if>
				</div>
				<#if mineMouthPicUrl??>
				<div style="height:150px;text-align:center;">
					<img src="${mineMouthPicUrl!}" style="height:100%;">
				</div>
				</#if>
				<table class="table address">
					<tbody>
						<tr>
							<td style="width: 83px;">详细地址：</td>
							<td>${mineRegionName!}${goods.companies.address!}</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
		</#if>
		<div style="height: 50px;"></div>
		<div class="clearfix"></div>
	</div>
	<script src="${base}/assets/js/jquery.min.js"
		type="text/javascript"></script>
	<script src="${base}/assets/js/highcharts.js"
		type="text/javascript"></script>
	<script	src="${base}/assets/js/bootstrap.min.js"
		type="text/javascript"></script>
	<script src="//webapi.amap.com/maps?v=1.4.11&key=121fead7c8124c5197aceceb50ba0441" 
		type="text/javascript"></script>
	<script>
		$(document).ready(function() {
			inithighcharts(7);
		});
		
		function  inithighcharts(daynum){
			$.ajax({
				type : 'get',
				url : 'coalpricechart.json',
				data : {'goodsId':'${goods.goodsId!}','day':daynum},
				dataType : "json",
				success : function(data) {
				console.log(data)
					$('#container').highcharts({
						title : {
							text : '',
							
						},
						xAxis : {
							categories : data.categories
						},
						yAxis : {
							title : {
								text : ''
							}
						},
						tooltip : {
							valueSuffix : '元/吨',
							style : {
								fontSize : '16px'
							}
						},
						legend : {
							align : 'right',
							verticalAlign : 'right',
							floating : true,
							borderWidth : 0,
							itemStyle : {
								fontSize : '16px',
							}
						},
						plotOptions : {
							series : {
								events : {
									legendItemClick : function(event) {
										return false;
									}
								}
							}
						},
						series : [ {
							name : '价格',
							showInLegend: false,                          
							data : data.oneQuote
						} ]
					});
			
				}
			});
		}
		
		function companiesPosition(){
			var marker = new AMap.Marker({
			    position: [${goods.companies.longitude!},${goods.companies.latitude!}]
			});
			marker.markOnAMAP({
			    position: marker.getPosition(),
			    name: '${goods.companies.mineMouthName!}'
			});
		}
	</script>
</body>
</html>

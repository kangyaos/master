<div class="modal fade bs-modal-lg" id="selectuser" tabindex="-1"
	role="dialog" aria-hidden="true" data-backdrop="static"
	data-keyboard="false">
	<div class="modal-dialog modal-lg">
		<div class="modal-content">
			<div class="modal-header">
				<div class="row">
					<div class='col-md-4 col-sm-6 col-xs-6 '
						style='text-align: left;padding: 0;height: 35px;font-size: 14px;padding: 7px 0px;'
						id='quanguo'>全国</div>
					<div class="col-md-4 col-sm-6 col-xs-6">
						<input type="text" style="padding: 0 15px 0 0;"
							class="form-control" placeholder="搜索"
							onkeyup="selectminelistbysearch(this.value)">
					</div>
				</div>
				<div class="location "></div>
			</div>
			<div class="modal-body">
				<table class="table table-striped table-bordered table-hover"
					id="selectgrid">
				</table>
			</div>
			<div class="txt">
				<div class="selecteditem" style="display:none"></div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn default" data-dismiss="modal">关闭</button>
				<button type="button" class="btn blue" id="selectok">选择</button>
			</div>
		</div>
		<!-- /.modal-content -->
	</div>
	<!-- /.modal-dialog -->
</div>

<script>
	var minedata=null;
	var table ;
	var stype=0,sregion='',ssearch='';
	var selectTable = function() {	
		table = $('#selectgrid');	
		table.dataTable({
    		"dom" : "<'row'<'col-md-12 select-filter'>><'table-scrollable't><'row'<'col-md-4 col-sm-12'i><'col-md-8 col-sm-12'p>>",
    		"stateSave" : false,
    		"pagingType": "full",
    		"language": {
				"info" : "",
				"infoEmpty" : "",
				"zeroRecords" : "没有检索到数据",
				"emptyTable" : "没有检索到数据",
		        "paginate": {
		        	"first": '首页',
		            "previous": '上一页',
		            "next": '下一页',
		            "last": '末页'
		        }
		    },
    		"ajax": {
                "type": "post",
                "url": "${base}/selectcompany.json?position="+position,                
                "error":function(ex){
                	console.log(ex);
                }
            },
            "columns" : [
            			{"data" : "name","sDefaultContent" : "",
								"fnCreatedCell" : function (nTd, sData, oData, iRow, iCol) {
				                	    $(nTd).html(sData +" <span class='address'>"+oData.address+"</span> <span style='float: right;'> "+oData.distance+"米</span>");
				            	},
							}
					]
        });

        $(".select-filter input[type='text']").on('keyup change', function () {        	
        	var api = table.api();
			api.column(1).search($('#m1').val());
			api.column(2).search($('#m2').val());
			api.column(3).search($('#m3').val());			
			api.column(4).search($('#m4').val());
			api.draw();
        });
        
       	var api = table.api();
           //给行绑定选中事件
        $('#selectgrid tbody').on( 'click', 'tr', function () { // 单击table中的tr标签触发该方法
            if ($(this).hasClass('selected')) { // 给被单击的tr方法添加一个 class
                $(this).removeClass('selected');
            }
            else {
                api.$('tr.selected').removeClass('selected');
                $(this).addClass('selected');
            }
            minedata=api.row('.selected').data();// 利用 DataTables 对象去获取被单击的tr中的数据并打印
        });
            
        $('#selectok').on('click', function(){   
	        if(minedata==null){
	         	alert("请选择矿口");
	        } else{
	          	$('#selectuser').modal('hide');
	          	selectaddmine(minedata);
	        } 
        });
	};
	
    var htmlstr="";
    //添加以选择的矿selectedmouth
     function selecteditem(selected,selectname,arrays){
       if(selected.length > 0){    

		}else{
		   
		}
    }
    
    function  selectminelistbyregion(region){
      sregion=region;
      table.fnReloadAjax("${base}/selectcompany.json?region="+region+"&type="+stype+"&search="+ssearch+"&position="+position);
    }
     
 
     
    function  selectminelistbysearch(search){
      ssearch=search;
      table.fnReloadAjax("${base}/selectcompany.json?region="+sregion+"&type="+stype+"&search="+search+"&position="+position);
    }
    
    var selectok = function(selected,selectname,arrays){
        $("#district_cn").val(arrays);
        $("#mouth").val(selected);
        //$(".selecteditem").css("display","none");
        $("#district_cn").css("display","none");
        $(".selectedmouth").css("display","block");
	};

</script>